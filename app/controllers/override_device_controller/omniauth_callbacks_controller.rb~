class OverrideDeviceController::OmniauthCallbacksController < DeviseTokenAuth::OmniauthCallbacksController


  def redirect_callbacks
    super
    p request.env['omniauth.params']
    p request.env['omniauth.auth']
    p redirect_route

  end

  def omniauth_success
    get_resource_from_auth_hash
    create_token_info
    set_token_on_resource
    create_auth_params

    if resource_class.devise_modules.include?(:confirmable)
      # don't send confirmation email!!!
      @resource.skip_confirmation!
    end

    sign_in(:user, @resource, store: false, bypass: false)

    @resource.save!
    
    yield @resource if block_given?

    new_auth_header = @resource.create_new_auth_token
    response.headers.merge!(new_auth_header)

    render json: @resource
  end


  def send_resource resource

  end
end
